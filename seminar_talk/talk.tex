\documentclass{beamer}
\usepackage{tikz}
\usepackage[style=authoryear]{biblatex}
\usepackage{empheq}
\usepackage{pifont}
\usepackage{colortbl}
\usepackage{enumitem}

\setitemize{label=\usebeamerfont*{itemize item}%
  \usebeamercolor[fg]{itemize item}
  \usebeamertemplate{itemize item}}

\usetheme{Singapore}
\usecolortheme{lily}
\beamertemplatenavigationsymbolsempty

\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{calc}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes}
\tikzstyle{every picture}+=[remember picture]
\tikzset{onslide/.code args={<#1>#2}{%
  \only<#1>{\pgfkeysalso{#2}}
}}

\newcommand\independent{\protect\mathpalette{\protect\independenT}{\perp}}
\def\independenT#1#2{\mathrel{\rlap{$#1#2$}\mkern2mu{#1#2}}}

\DeclareMathOperator{\ifff}{:-}
\DeclareMathOperator{\prob}{::}
\DeclareMathOperator{\negg}{\backslash+}

\newcommand{\cmark}{\textcolor{green!50!black}{\ding{51}}}%
\newcommand{\xmark}{\textcolor{red}{\ding{55}}}%

\definecolor{predicate}{HTML}{1b9e77}
\definecolor{probability}{HTML}{e7298a}
\definecolor{variable}{HTML}{d95f02}
\definecolor{constant}{HTML}{7570b3}
\definecolor{color5}{HTML}{66a61e}
\definecolor{color6}{HTML}{e6ab02}

\addbibresource{talk.bib}

\author{Paulius Dilkas}
\title{Generating Random Logic Programs Using Constraint Programming}
\date{AIAI Seminar}

\begin{document}

\begin{frame}[noframenumbering,plain]
  \tikz[remember picture,overlay]{
    \node at ([yshift=25pt,xshift=30pt]current page.south)
    {\includegraphics[height=40pt]{inf.png}};
    \node at ([yshift=25pt,xshift=75pt]current page.south)
    {\includegraphics[height=40pt]{ecr.jpg}};
    \node at ([yshift=20pt,xshift=140pt]current page.south)
    {\includegraphics[height=20pt]{epsrc.png}};
  }
  \titlepage
\end{frame}

\begin{frame}{How Many Programs Are Used to Test Algorithms?}
  \begin{columns}
    \begin{column}{0.5\textwidth}
      \pause
      \fbox{
        \begin{tikzpicture}
          \node[inner sep = 0pt] (a) {\includegraphics[width=\textwidth]{inference3.png}};
          \node[anchor=center] at (a.center) {\Huge\alert{4}};
        \end{tikzpicture}
      }
      \pause
      \fbox{
        \begin{tikzpicture}
          \node[inner sep = 0pt] (a) {\includegraphics[width=\textwidth]{inference8.png}};
          \node[anchor=center] at (a.center) {\Huge\alert{3}};
        \end{tikzpicture}
      }
      \pause
      \fbox{
        \begin{tikzpicture}
          \node[inner sep = 0pt] (a) {\includegraphics[width=\textwidth]{inference7.png}};
          \node[anchor=center] at (a.center) {\Huge\alert{1}};
        \end{tikzpicture}
      }
    \end{column}
    \begin{column}{0.5\textwidth}
      \pause
      \fbox{
        \begin{tikzpicture}
          \node[inner sep = 0pt] (a) {\includegraphics[width=\textwidth]{inference6.png}};
          \node[anchor=center] at (a.center) {\Huge\alert{1}};
        \end{tikzpicture}
      }
      \pause
      \fbox{
        \begin{tikzpicture}
          \node[inner sep = 0pt] (a) {\includegraphics[width=\textwidth]{inference2.png}};
          \node[anchor=center] at (a.center) {\Huge\alert{1}};
        \end{tikzpicture}
      }
      \pause
      \fbox{
        \begin{tikzpicture}
          \node[inner sep = 0pt] (a) {\includegraphics[width=\textwidth]{inference1.png}};
          \node[anchor=center] at (a.center) {\Huge\alert{2}};
        \end{tikzpicture}
      }
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}
  \frametitle{Outline}
  \tableofcontents
\end{frame}

\section{Probabilistic Logic Programming}

\begin{frame}{Probabilistic Logic Programs (\textsc{ProbLog})}
  \begin{block}{``Smokers'' (\cite{DBLP:conf/ilp/DomingosKLPRS08,DBLP:journals/tplp/FierensBRSGTJR15})}
    \vspace*{-\baselineskip}\setlength\belowdisplayshortskip{0pt}
    \begin{align*}
      \textcolor{probability}{0.2} \prob &\textcolor{predicate}{\mathtt{stress}}(\textcolor{variable}{\mathsf{P}}) \ifff \textcolor{predicate}{\mathtt{person}}(\textcolor{variable}{\mathsf{P}}). \\
      \textcolor{probability}{0.3} \prob &\textcolor{predicate}{\mathtt{influences}}(\textcolor{variable}{\mathsf{P}_1}, \textcolor{variable}{\mathsf{P}_2}) \ifff \textcolor{predicate}{\mathtt{friend}}(\textcolor{variable}{\mathsf{P}_1}, \textcolor{variable}{\mathsf{P}_2}). \\
      \textcolor{probability}{0.1} \prob &\textcolor{predicate}{\mathtt{cancer\_spont}}(\textcolor{variable}{\mathsf{P}}) \ifff \textcolor{predicate}{\mathtt{person}}(\textcolor{variable}{\mathsf{P}}). \\
      \textcolor{probability}{0.3} \prob &\textcolor{predicate}{\mathtt{cancer\_smoke}}(\textcolor{variable}{\mathsf{P}}) \ifff \textcolor{predicate}{\mathtt{person}}(\textcolor{variable}{\mathsf{P}}). \\
                                         &\textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{X}}) \ifff \textcolor{predicate}{\mathtt{stress}}(\textcolor{variable}{\mathsf{X}}). \\
                                         &\textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{X}}) \ifff \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{Y}}), \textcolor{predicate}{\mathtt{influences}}(\textcolor{variable}{\mathsf{Y}}, \textcolor{variable}{\mathsf{X}}). \\
                                         &\textcolor{predicate}{\mathtt{cancer}}(\textcolor{variable}{\mathsf{P}}) \ifff \textcolor{predicate}{\mathtt{cancer\_spont}}(\textcolor{variable}{\mathsf{P}}). \\
                                         &\textcolor{predicate}{\mathtt{cancer}}(\textcolor{variable}{\mathsf{P}}) \ifff \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{P}}), \textcolor{predicate}{\mathtt{cancer\_smoke}}(\textcolor{variable}{\mathsf{P}}). \\
                                         &\textcolor{predicate}{\mathtt{person}}(\textcolor{constant}{\mathit{michelle}}). \\
                                         &\textcolor{predicate}{\mathtt{person}}(\textcolor{constant}{\mathit{timothy}}). \\
                                         &\textcolor{predicate}{\mathtt{friend}}(\textcolor{constant}{\mathit{timothy}}, \textcolor{constant}{\mathit{michelle}}).
    \end{align*}
  \end{block}
\end{frame}

\begin{frame}{Applications}
  \begin{columns}[b]
    \begin{column}{0.5\textwidth}
      \centering
      \includegraphics[width=\textwidth]{application1.png}
      {\small \cite{DBLP:conf/icra/MoldovanMOSR12}}
    \end{column}
    \begin{column}{0.5\textwidth}
      \centering
      \includegraphics[width=\textwidth]{application3.png}
      {\small \cite{DBLP:conf/ijcai/DriesKDBR17}}
    \end{column}
  \end{columns}
  \vfill
  \begin{columns}[b]
    \begin{column}{0.5\textwidth}
      \centering
      \includegraphics[width=\textwidth]{application2.png}
      {\small \cite{DBLP:conf/ilp/Corte-RealD017}}
    \end{column}
    \begin{column}{0.5\textwidth}
      \centering
      \includegraphics[width=\textwidth]{application4.png}
      {\small \cite{de2013phenetic}}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}{Probabilistic Inference}
  \begin{minipage}[t][0.5\textheight]{\textwidth}
    Let \alert{$a \oplus b \coloneqq a + b - ab$}. Then

    \only<1>{
      $\begin{aligned}[t]
        \Pr[\textcolor{predicate}{\mathtt{cancer}}(\textcolor{constant}{\mathit{michelle}})]
        &=
        \Pr[\textcolor{predicate}{\mathtt{cancer\_spont}}(\textcolor{constant}{\mathit{michelle}})]
        \\
        &\oplus
        \Pr[\textcolor{predicate}{\mathtt{smokes}}(\textcolor{constant}{\mathit{michelle}})]
        \\
        &\times
        \Pr[\textcolor{predicate}{\mathtt{cancer\_smoke}}(\textcolor{constant}{\mathit{michelle}})]
      \end{aligned}$
    }
    \only<2->{
      $\Pr[\textcolor{predicate}{\mathtt{cancer}}(\textcolor{constant}{\mathit{michelle}})]
      = \textcolor{probability}{0.1} \oplus \textcolor{probability}{0.3} \times
      \Pr[\textcolor{predicate}{\mathtt{smokes}}(\textcolor{constant}{\mathit{michelle}})]$
    }

    \only<3>{
      $\begin{aligned}[t]
        \Pr[\textcolor{predicate}{\mathtt{smokes}}(\textcolor{constant}{\mathit{michelle}})]
        &=
        \Pr[\textcolor{predicate}{\mathtt{stress}}(\textcolor{constant}{\mathit{michelle}})]
        \\
        &\oplus
        \Pr[\textcolor{predicate}{\mathtt{smokes}}(\textcolor{constant}{\mathit{timothy}})]
        \\
        &\times
        \Pr[\textcolor{predicate}{\mathtt{influences}}(\textcolor{constant}{\mathit{timothy}},
        \textcolor{constant}{\mathit{michelle}})]
      \end{aligned}$
    }
    \only<4->{
      $\Pr[\textcolor{predicate}{\mathtt{smokes}}(\textcolor{constant}{\mathit{michelle}})]
      = \textcolor{probability}{0.2} \oplus \textcolor{probability}{0.3} \times
      \Pr[\textcolor{predicate}{\mathtt{smokes}}(\textcolor{constant}{\mathit{timothy}})]$
    }

    \only<5->{
      $\Pr[\textcolor{predicate}{\mathtt{smokes}}(\textcolor{constant}{\mathit{timothy}})]
      =
      \Pr[\textcolor{predicate}{\mathtt{stress}}(\textcolor{constant}{\mathit{timothy}})]
      = \textcolor{probability}{0.2}$
    }
  \end{minipage}
  \vfill
  \begin{overprint}
    \begin{onlyenv}<1>
      \begin{empheq}[box=\fbox]{align*}
        \textcolor{predicate}{\mathtt{cancer}}(\textcolor{variable}{\mathsf{P}})
        &\ifff
        \textcolor{predicate}{\mathtt{cancer\_spont}}(\textcolor{variable}{\mathsf{P}}).
        \\
        \textcolor{predicate}{\mathtt{cancer}}(\textcolor{variable}{\mathsf{P}})
        &\ifff
        \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{P}}),
        \textcolor{predicate}{\mathtt{cancer\_smoke}}(\textcolor{variable}{\mathsf{P}}).
      \end{empheq}
    \end{onlyenv}
    \begin{onlyenv}<2>
      \begin{empheq}[box=\fbox]{align*}
        \textcolor{probability}{0.1} \prob
        &\textcolor{predicate}{\mathtt{cancer\_spont}}(\textcolor{variable}{\mathsf{P}})
        \ifff
        \textcolor{predicate}{\mathtt{person}}(\textcolor{variable}{\mathsf{P}}).
        \\
        \textcolor{probability}{0.3} \prob
        &\textcolor{predicate}{\mathtt{cancer\_smoke}}(\textcolor{variable}{\mathsf{P}})
        \ifff
        \textcolor{predicate}{\mathtt{person}}(\textcolor{variable}{\mathsf{P}}).
      \end{empheq}
    \end{onlyenv}
    \begin{onlyenv}<3>
      \begin{empheq}[box=\fbox]{align*}
        \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{X}})
        &\ifff
        \textcolor{predicate}{\mathtt{stress}}(\textcolor{variable}{\mathsf{X}}).
        \\
        \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{X}})
        &\ifff
        \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{Y}}),
        \textcolor{predicate}{\mathtt{influences}}(\textcolor{variable}{\mathsf{Y}},
        \textcolor{variable}{\mathsf{X}}).
      \end{empheq}
    \end{onlyenv}
    \begin{onlyenv}<4>
      \begin{empheq}[box=\fbox]{align*}
        \textcolor{probability}{0.2} \prob &\textcolor{predicate}{\mathtt{stress}}(\textcolor{variable}{\mathsf{P}}) \ifff \textcolor{predicate}{\mathtt{person}}(\textcolor{variable}{\mathsf{P}}). \\
        \textcolor{probability}{0.3} \prob &\textcolor{predicate}{\mathtt{influences}}(\textcolor{variable}{\mathsf{P}_1}, \textcolor{variable}{\mathsf{P}_2}) \ifff \textcolor{predicate}{\mathtt{friend}}(\textcolor{variable}{\mathsf{P}_1}, \textcolor{variable}{\mathsf{P}_2}).
      \end{empheq}
    \end{onlyenv}
    \begin{onlyenv}<5>
      \begin{empheq}[box=\fbox]{align*}
        \textcolor{probability}{0.2} \prob &\textcolor{predicate}{\mathtt{stress}}(\textcolor{variable}{\mathsf{P}}) \ifff \textcolor{predicate}{\mathtt{person}}(\textcolor{variable}{\mathsf{P}}). \\
        &\textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{X}}) \ifff \textcolor{predicate}{\mathtt{stress}}(\textcolor{variable}{\mathsf{X}}).
      \end{empheq}
    \end{onlyenv}
  \end{overprint}
\end{frame}

\begin{frame}{Inference Algorithms and Knowledge Compilation Maps}
  \begin{description}
  \item[NNF] negation normal form
  \item[BDD] binary decision diagrams
  \item[SDD] sentential decision diagrams
  \item[$k$-Best] only use the \alert{$k$} most probable proofs
  \item[d-DNNF] deterministic decomposable negation normal form
    \begin{itemize}
    \item<2-> for every pair \alert{$\alpha \lor \beta$}, we have \alert{$\alpha
        \land \beta = \bot$}
    \item<2-> for every pair \alert{$\alpha \land \beta$}, no atoms are shared
      between \alert{$\alpha$} and \alert{$\beta$}
    \item[\xmark\xmark]<3> $(A \lor C) \land (A \lor \neg B)$
    \item[\xmark\cmark]<3> $C \land (A \lor \neg B)$
    \item[\cmark\xmark]<3> $B \land C \land [(B \land A) \lor \neg B]$
    \item[\cmark\cmark]<3> $C \land [(B \land A) \lor \neg B]$
    \end{itemize}
  \end{description}
\end{frame}

\begin{frame}{Example Diagrams for \alert{$C \land (A \lor \neg B)$}}
  \begin{columns}[b]
    \begin{column}{0.33\textwidth}
      \begin{figure}
        \centering
        \begin{tikzpicture}[level distance=0.8cm]
          \node[draw,circle] {$\land$}
          child {node[draw,rectangle] {$C$}}
          child {node[draw,circle] {$\lor$}
            child {node[draw,rectangle] {$A$}}
            child {node[draw,rectangle] {$\neg B$}
            }
          };
        \end{tikzpicture}
        \caption{NNF}
      \end{figure}
      \vspace{-1em}
      \begin{figure}
      \centering
        \begin{tikzpicture}[level distance=0.8cm]
          \node[draw,circle] (A) {$A$}
          child {edge from parent[draw=none]}
          child {node[draw,circle] (B) {$B$} edge from parent[dashed]
            child {node[draw,circle,solid] (C) {$C$} edge from parent[dashed]
              child {node[draw,rectangle,solid] {$1$} edge from parent[solid]}
              child {node[draw,rectangle,solid] (0) {$0$}}
            }
            child {edge from parent[draw=none]}
          };
          \draw (A) -- (C);
          \draw (B) -- (0);
        \end{tikzpicture}
        \caption{BDD}
      \end{figure}
    \end{column}
    \begin{column}{0.33\textwidth}
      \begin{figure}
        \centering
        \begin{tikzpicture}[level distance=0.8cm]
          \node[draw,circle] {$\land$}
          child {node[draw,circle] {$\lor$}
            child {node[draw,circle] (parent) {$\land$}
              child {node[draw,rectangle] {$B$}}
              child {edge from parent[draw=none]}
            }
            child {node[draw,circle] {$\land$}
              child {node[draw,circle] {$\lor$}
                child {node[draw,rectangle] (A) {$A$}}
                child {node[draw,rectangle] {$\neg A$}}
              }
              child {node[draw,rectangle] {$\neg B$}}
            }
          }
          child {node[draw,rectangle] {$C$}};
          \draw (parent) -- (A);
        \end{tikzpicture}
        \caption{d-DNNF}
      \end{figure}
    \end{column}
    \begin{column}{0.33\textwidth}
      \begin{figure}
        \centering
        \begin{tikzpicture}[level distance=0.8cm]
          \tikzset{
            mysplit/.style={
              draw,
              rectangle,
              rectangle split,
              rectangle split horizontal,
              rectangle split parts=2
            }
          }
          \node[draw,circle] {$1$}
          child {node[mysplit] (bullet) {
              \nodepart{one} $\neg A$
              \nodepart{two}
            }
            child {node[draw,circle] (3) {$3$} edge from parent[draw=none]
              child {node[mysplit] {
                  \nodepart{one} $\neg B$
                  \nodepart{two} $C$
                }
              }
              child {node[mysplit] {
                  \nodepart{one} $B$
                  \nodepart{two} $\bot$
                }
              }
            }
          }
          child {node[mysplit] {
              \nodepart{one} $A$
              \nodepart{two} $C$
            }};
          \draw[*-] let \p1 = (bullet.two), \p2 = (bullet.center) in ({\x1 + 2.5},{\y2 + 2}) -- (3);
        \end{tikzpicture}
        \caption{SDD}
      \end{figure}
      \vspace{-2em}
      \begin{figure}
      \centering
      \begin{tikzpicture}[level distance=0.8cm]
        \node[draw,circle] {$1$}
        child {node[draw,circle] {$0$}
          child {node[draw,rectangle] {$A$}}
        }
        child {node[draw,circle] {$3$}
          child {node[draw,circle] {$2$}
            child {node[draw,rectangle] {$B$}}
          }
          child {node[draw,circle] {$4$}
            child {node[draw,rectangle] {$C$}}
          }
        };
      \end{tikzpicture}
      \caption{vtree}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}

\section{The Constraint Model}

\begin{frame}{What Characterises a (Probabilistic) Logic Program?}
  \begin{columns}
    \hspace*{-0.7cm}\begin{column}{0.75\textwidth}
      \begin{empheq}[left =\onslide<6->{\color{color5}\empheqlbrace}]{equation}
        \begin{align*}
      \textcolor<5->{probability}{0.2} \prob &\textcolor<2->{predicate}{\mathtt{stress}}(\textcolor<3->{variable}{\mathsf{P}}) \ifff \textcolor<2->{predicate}{\mathtt{person}}(\textcolor<3->{variable}{\mathsf{P}}). \\
      \textcolor<5->{probability}{0.3} \prob &\textcolor<2->{predicate}{\mathtt{influences}}(\textcolor<3->{variable}{\mathsf{P}_1}, \textcolor<3->{variable}{\mathsf{P}_2}) \ifff \textcolor<2->{predicate}{\mathtt{friend}}(\textcolor<3->{variable}{\mathsf{P}_1}, \textcolor<3->{variable}{\mathsf{P}_2}). \\
      \textcolor<5->{probability}{0.1} \prob &\textcolor<2->{predicate}{\mathtt{cancer\_spont}}(\textcolor<3->{variable}{\mathsf{P}}) \ifff \textcolor<2->{predicate}{\mathtt{person}}(\textcolor<3->{variable}{\mathsf{P}}). \\
      \textcolor<5->{probability}{0.3} \prob &\textcolor<2->{predicate}{\mathtt{cancer\_smoke}}(\textcolor<3->{variable}{\mathsf{P}}) \ifff \textcolor<2->{predicate}{\mathtt{person}}(\textcolor<3->{variable}{\mathsf{P}}). \\
                                         &\textcolor<2->{predicate}{\mathtt{smokes}}(\textcolor<3->{variable}{\mathsf{X}}) \ifff \textcolor<2->{predicate}{\mathtt{stress}}(\textcolor<3->{variable}{\mathsf{X}}). \\
                                         &\textcolor<2->{predicate}{\mathtt{smokes}}(\textcolor<3->{variable}{\mathsf{X}}) \ifff \textcolor<2->{predicate}{\mathtt{smokes}}(\textcolor<3->{variable}{\mathsf{Y}}), \textcolor<2->{predicate}{\mathtt{influences}}(\textcolor<3->{variable}{\mathsf{Y}}, \textcolor<3->{variable}{\mathsf{X}}). \\
                                         &\textcolor<2->{predicate}{\mathtt{cancer}}(\textcolor<3->{variable}{\mathsf{P}}) \ifff \textcolor<2->{predicate}{\mathtt{cancer\_spont}}(\textcolor<3->{variable}{\mathsf{P}}). \\
                                         &\textcolor<2->{predicate}{\mathtt{cancer}}(\textcolor<3->{variable}{\mathsf{P}}) \ifff \tikz \coordinate (start);\textcolor<2->{predicate}{\mathtt{smokes}}(\textcolor<3->{variable}{\mathsf{P}}), \textcolor<2->{predicate}{\mathtt{cancer\_smoke}}(\textcolor<3->{variable}{\mathsf{P}})\tikz \coordinate (end);. \\
                                         &\textcolor<2->{predicate}{\mathtt{person}}(\textcolor<4->{constant}{\mathit{michelle}}). \\
                                         &\textcolor<2->{predicate}{\mathtt{person}}(\textcolor<4->{constant}{\mathit{timothy}}). \\
                                         &\textcolor<2->{predicate}{\mathtt{friend}}(\textcolor<4->{constant}{\mathit{timothy}}, \textcolor<4->{constant}{\mathit{michelle}}).
        \end{align*}
      \end{empheq}
    \end{column}
    \begin{column}{0.25\textwidth}
      \begin{itemize}
      \item[\textcolor{predicate}{\textbullet}]<2-> predicates, arities
      \item[\textcolor{variable}{\textbullet}]<3-> variables
      \item[\textcolor{constant}{\textbullet}]<4-> constants
      \item[\textcolor{probability}{\textbullet}]<5-> probabilities
      \item[\textcolor{color5}{\textbullet}]<6-> length
      \item[\textcolor{color6}{\textbullet}]<7-> complexity
      \end{itemize}
    \end{column}
  \end{columns}
  \onslide<7->{
    \begin{tikzpicture}[overlay]
      \draw [decorate,decoration={brace,amplitude=10pt,mirror},color=color6] (start) -- (end);
    \end{tikzpicture}
  }
\end{frame}

% 1. Formula
% 2. Tree
% 3. First two rows
% 4. s is a forest
% 5. first digit
% 6. sorted, implication
% 7. length, number of nodes, for
% 8. third row, last 3 constraints

\begin{frame}{Formulas As Trees}
  \begin{columns}
    \begin{column}{0.37\textwidth}
      \[
        \neg \textcolor{predicate}{\mathtt{p}}(\textcolor{variable}{\mathsf{X}})
        \lor (\textcolor{predicate}{\mathtt{q}}(\textcolor{variable}{\mathsf{X}})
        \land \textcolor{predicate}{\mathtt{r}}(\textcolor{variable}{\mathsf{X}}))
      \]
      \onslide<2->{
        \begin{tikzpicture}[level 1/.style={sibling distance=30mm},level 2/.style={sibling distance=15mm}]
          \node[draw,circle] {$\lor$}
          child {node[draw,circle] {$\neg$}
            child {node[draw,rectangle] {$\textcolor{predicate}{\mathtt{p}}(\textcolor{variable}{\mathsf{X}})$}}
          }
          child {node[draw,circle] {$\land$}
            child {node[draw,rectangle] {$\textcolor{predicate}{\mathtt{q}}(\textcolor{variable}{\mathsf{X}})$}}
            child {node[draw,rectangle] {$\textcolor{predicate}{\mathtt{r}}(\textcolor{variable}{\mathsf{X}})$}}
          };
        \end{tikzpicture}
      }
      \begin{itemize}
      \item<6-> $\alert{\mathbf{s}}$ is sorted
      \item<6-> $\alert{\mathbf{s}_i \ne i} \implies \alert{\mathbf{v}_i \ne \top}$
      \end{itemize}
    \end{column}
    \begin{column}{0.63\textwidth}
      \alt<7>{\newcolumntype{C}{>{\columncolor{constant!25}}c}}{\newcolumntype{C}{c}}
      \alt<7>{\newcolumntype{D}{>{\columncolor{probability!25}}c}}{\newcolumntype{D}{c}}
      \centering
      \onslide<3->{
        \begin{tabular}{c c|C|C|C|C|C|D}
          \cline{2-8}
          $\alert{\mathbf{s}}\colon$ & \alert<5->{0} & 0 & 0 & 1 & 2 & 2 & 6 \\
          \cline{2-8}
          $\alert{\mathbf{v}}\colon$ & $\lor$ & $\neg$ & $\land$ & $\textcolor{predicate}{\mathtt{p}}(\textcolor{variable}{\mathsf{X}})$ & $\textcolor{predicate}{\mathtt{q}}(\textcolor{variable}{\mathsf{X}})$ & $\textcolor{predicate}{\mathtt{r}}(\textcolor{variable}{\mathsf{X}})$ & $\top$ \\
          \cline{2-8}
          \onslide<8->{$\alert{\mathbf{c}}\colon$ & 2 & 1 & 2 & 0 & 0 & 0 & 0 \\ \cline{2-8}}
        \end{tabular}
      }
      \begin{itemize}
      \item<4-> $\alert{\mathbf{s}}$ is a forest with $\alert{T = 2}$ trees
      \item<7-> length \alert{$L = 7$}
      \item<7-> number of nodes \alert{$N \coloneqq L - T + 1 = 6$}
      \item<7-> for \alert{$i = 1, \dots, L - 1$},
        \begin{itemize}
        \item if \alert{$i < N$}, then \alert{$\mathbf{s}_i < i$}
        \item else \alert{$\mathbf{s}_i = i$} and \alert{$\mathbf{v}_i = \top$}
        \end{itemize}
      \item<8-> $\alert{\mathbf{c}_i = 0} \iff \alert{\mathbf{v}_i = \top}$ or is a predicate
      \item<8-> $\alert{\mathbf{c}_i = 1} \iff \alert{\mathbf{v}_i = \neg}$
      \item<8-> $\alert{\mathbf{c}_i > 1} \iff \alert{\mathbf{v}_i \in \{ \land, \lor \}}$
      \end{itemize}
    \end{column}
  \end{columns}
\end{frame}

% TODO: a longer intro to experiments (the setup)
% TODO: conditional independence?
% TODO: and how is a predicate with its arguments represented?
% TODO: could add more experimental graphs
% TODO: a full(er) example of independence propagation
% TODO: could talk about what algorithms are behind the negative cycle detection
% TODO: for the bigraph talk, I had 28 slides full info and it still wasn't
% enough. Maybe I should aim for at least 30.
% TODO: more constraints
% TODO: more motivation and related work
\begin{frame}{Variable Symmetry Breaking}
  \begin{block}{The Problem}
    Let $\{ \textcolor{variable}{\mathsf{W}}, \textcolor{variable}{\mathsf{X}},
    \textcolor{variable}{\mathsf{Y}} \}$ be the set of variables. Then
    \[
      \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{X}})
      \ifff
      \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{Y}}),
      \textcolor{predicate}{\mathtt{influences}}(\textcolor{variable}{\mathsf{Y}},
      \textcolor{variable}{\mathsf{X}})
    \]
    is equivalent to
    \[
      \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{Y}})
      \ifff
      \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{X}}),
      \textcolor{predicate}{\mathtt{influences}}(\textcolor{variable}{\mathsf{X}},
      \textcolor{variable}{\mathsf{Y}})
    \]
    and to
    \[
      \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{W}})
      \ifff
      \textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{X}}),
      \textcolor{predicate}{\mathtt{influences}}(\textcolor{variable}{\mathsf{X}},
      \textcolor{variable}{\mathsf{W}})
    \]
  \end{block}
\end{frame}

\begin{frame}{Variable Symmetry Breaking}
  \begin{overprint}
    \onslide<1>
    \centering
    \begin{tabular}{|c|c|c|c|}
      \hline
      $\textcolor{variable}{\mathsf{X}}$ & $\textcolor{variable}{\mathsf{Y}}$ & $\textcolor{variable}{\mathsf{Y}}$ & $\textcolor{variable}{\mathsf{X}}$ \\
      \hline
    \end{tabular}
    \onslide<2>
    \centering
    \begin{tabular}{|c|c|c|c|}
      \hline
      $\textcolor{variable}{\mathsf{Y}}$ & $\textcolor{variable}{\mathsf{X}}$ & $\textcolor{variable}{\mathsf{X}}$ & $\textcolor{variable}{\mathsf{Y}}$ \\
      \hline
    \end{tabular}
    \onslide<3>
    \centering
    \begin{tabular}{|c|c|c|c|}
      \hline
      $\textcolor{variable}{\mathsf{W}}$ & $\textcolor{variable}{\mathsf{X}}$ & $\textcolor{variable}{\mathsf{X}}$ & $\textcolor{variable}{\mathsf{W}}$ \\
      \hline
    \end{tabular}
  \end{overprint}
  \vfill
  \begin{columns}[t]
    \begin{column}{0.5\textwidth}
      \begin{block}{\centering Occurrences}
        \centering
        (channeling)
        \begin{overprint}
          \onslide<1>
          \begin{align*}
            \textcolor{variable}{\mathsf{W}} &\mapsto \emptyset \\
            \textcolor{variable}{\mathsf{X}} &\mapsto \{ 0, 3 \} \\
            \textcolor{variable}{\mathsf{Y}} &\mapsto \{ 1, 2 \}
          \end{align*}
          \onslide<2>
          \begin{align*}
            \textcolor{variable}{\mathsf{W}} &\mapsto \emptyset \\
            \textcolor{variable}{\mathsf{X}} &\mapsto \alert{\{ 1, 2 \}} \\
            \textcolor{variable}{\mathsf{Y}} &\mapsto \alert{\{ 0, 3 \}}
          \end{align*}
          \onslide<3>
          \begin{align*}
            \textcolor{variable}{\mathsf{W}} &\mapsto \alert{\{ 0, 3 \}} \\
            \textcolor{variable}{\mathsf{X}} &\mapsto \{ 1, 2 \} \\
            \textcolor{variable}{\mathsf{Y}} &\mapsto \alert{\emptyset}
          \end{align*}
        \end{overprint}
      \end{block}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{block}{\centering Introductions}
        \centering
        $1 + \min \mathsf{occurrences}(v)$ or $0$
        \begin{overprint}
          \onslide<1>
          \begin{align*}
            \textcolor{variable}{\mathsf{W}} &\mapsto 0 \\
            \textcolor{variable}{\mathsf{X}} &\mapsto 1 \\
            \textcolor{variable}{\mathsf{Y}} &\mapsto 2
          \end{align*}
          \smallskip
          \onslide<2>
          \begin{align*}
            \textcolor{variable}{\mathsf{W}} &\mapsto 0 \\
            \textcolor{variable}{\mathsf{X}} &\mapsto \alert{2} \\
            \textcolor{variable}{\mathsf{Y}} &\mapsto \alert{1}
          \end{align*}
          \onslide<3>
          \begin{align*}
            \textcolor{variable}{\mathsf{W}} &\mapsto \alert{1} \\
            \textcolor{variable}{\mathsf{X}} &\mapsto 2 \\
            \textcolor{variable}{\mathsf{Y}} &\mapsto \alert{0}
          \end{align*}
        \end{overprint}
        \only<1>{\textcolor{green!50!black}{sorted!}}
        \only<2-3>{\alert{not sorted!}}
      \end{block}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}{Predicate Dependency Graph}
  \centering
  \begin{tikzpicture}
    \node[draw,ellipse] (friend) {\textcolor{predicate}{friend}};
    \node[draw,ellipse,right=of friend] (influences) {\textcolor{predicate}{influences}};
    \node[draw,ellipse,below=of influences] (stress) {\textcolor{predicate}{stress}};
    \node[draw,ellipse,below=of stress] (spont) {\textcolor{predicate}{cancer\_spont}};
    \node[draw,ellipse,below=of spont] (smoke) {\textcolor{predicate}{cancer\_smoke}};
    \node[draw,ellipse,left=of spont] (person) {\textcolor{predicate}{person}};
    \node[draw,ellipse,right=of spont] (cancer) {\textcolor{predicate}{cancer}};
    \node[draw,ellipse,above=of cancer] (smokes) {\textcolor{predicate}{smokes}};
    \draw[-{Latex[length=2mm]}] (friend) -- (influences);
    \draw[-{Latex[length=2mm]}] (influences) -- (smokes);
    \draw[-{Latex[length=2mm]}] (smokes) -- (cancer);
    \draw[-{Latex[length=2mm]}] (stress) -- (smokes);
    \draw[-{Latex[length=2mm]}] (spont) -- (cancer);
    \draw[-{Latex[length=2mm]}] (smoke) -- (cancer);
    \draw[-{Latex[length=2mm]}] (person) -- (stress);
    \draw[-{Latex[length=2mm]}] (person) -- (spont);
    \draw[-{Latex[length=2mm]}] (person) -- (smoke);
  \end{tikzpicture}
\end{frame}

% TODO: all the extra plots and example I had in the appendix
\begin{frame}{Stratification and Negative Cycles}
  \[
    \textcolor{probability}{0.1} \prob
    \textcolor{predicate}{\mathtt{friend}}(\textcolor{variable}{\mathsf{X}},
    \textcolor{variable}{\mathsf{Y}}) \ifff
    \negg\textcolor{predicate}{\mathtt{smokes}}(\textcolor{variable}{\mathsf{Y}}).
  \]
  \vfill
  \begin{columns}
    \begin{column}{0.4\textwidth}
      \begin{itemize}[leftmargin=0pt]
      \item<3-> \alert{Stratum 1}: predicates with no negation
      \item<3-> \alert{Stratum 2}: new predicates s.t. negative literals refer to
        predicates in \alert{Stratum~1}
      \end{itemize}
      \vspace{5em}
    \end{column}
    \begin{column}{0.6\textwidth}
      \hspace{-6.92em}
      \begin{tikzpicture}
        \node[draw,ellipse] (friend) {\textcolor{predicate}{friend}};
        \node[draw,ellipse,right=of friend] (influences) {\textcolor{predicate}{influences}};
        \node[draw,ellipse,below=of influences] (stress) {\textcolor{predicate}{stress}};
        \node[draw,ellipse,below=of stress] (spont) {\textcolor{predicate}{cancer\_spont}};
        \node[draw,ellipse,below=of spont] (smoke) {\textcolor{predicate}{cancer\_smoke}};
        \node[draw,ellipse,left=of spont] (person) {\textcolor{predicate}{person}};
        \node[draw,ellipse,right=of spont] (cancer) {\textcolor{predicate}{cancer}};
        \node[draw,ellipse,above=of cancer] (smokes) {\textcolor{predicate}{smokes}};
        \draw[-{Latex[length=2mm]}] (friend) -- (influences);
        \draw[-{Latex[length=2mm]}] (influences) -- (smokes);
        \draw[-{Latex[length=2mm]}] (smokes) -- (cancer);
        \draw[-{Latex[length=2mm]}] (stress) -- (smokes);
        \draw[-{Latex[length=2mm]}] (spont) -- (cancer);
        \draw[-{Latex[length=2mm]}] (smoke) -- (cancer);
        \draw[-{Latex[length=2mm]}] (person) -- (stress);
        \draw[-{Latex[length=2mm]}] (person) -- (spont);
        \draw[-{Latex[length=2mm]}] (person) -- (smoke);
        \draw<2->[-{Latex[length=2mm]},draw=red] (smokes) -- (friend);
      \end{tikzpicture}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}{Independence: $\textcolor{predicate}{\mathrm{friend}} \independent \textcolor{predicate}{\mathrm{stress}}$}
  \centering
  \begin{tikzpicture}
    \node[draw,ellipse,onslide=<2->{fill=constant!25}] (friend) {\textcolor{predicate}{friend}};
    \node[draw,ellipse,right=of friend] (influences) {\textcolor{predicate}{influences}};
    \node[draw,ellipse,onslide=<2->{fill=variable!25},below=of influences] (stress) {\textcolor{predicate}{stress}};
    \node[draw,ellipse,below=of stress] (spont) {\textcolor{predicate}{cancer\_spont}};
    \node[draw,ellipse,below=of spont] (smoke) {\textcolor{predicate}{cancer\_smoke}};
    \node[draw,ellipse,onslide=<2->{fill=variable!25},left=of spont] (person) {\textcolor{predicate}{person}};
    \node[draw,ellipse,right=of spont] (cancer) {\textcolor{predicate}{cancer}};
    \node[draw,ellipse,above=of cancer] (smokes) {\textcolor{predicate}{smokes}};
    \draw[-{Latex[length=2mm]}] (friend) -- (influences);
    \draw[-{Latex[length=2mm]}] (influences) -- (smokes);
    \draw[-{Latex[length=2mm]}] (smokes) -- (cancer);
    \draw[-{Latex[length=2mm]}] (stress) -- (smokes);
    \draw[-{Latex[length=2mm]}] (spont) -- (cancer);
    \draw[-{Latex[length=2mm]}] (smoke) -- (cancer);
    \draw[-{Latex[length=2mm]}] (person) -- (stress);
    \draw[-{Latex[length=2mm]}] (person) -- (spont);
    \draw[-{Latex[length=2mm]}] (person) -- (smoke);

    \draw<3->[-{Latex[length=2mm]}] (friend) edge[draw=red,bend left=15] (person);
    \draw<3->[-{Latex[length=2mm]}] (person) edge[draw=red,bend left=15] (friend);

    \draw<3->[-{Latex[length=2mm]}] (stress) edge[draw=red,bend left=15] (friend);
    \draw<3->[-{Latex[length=2mm]}] (friend) edge[draw=red,bend left=15] (stress);
  \end{tikzpicture}
\end{frame}

\section{Experimental Results}

\begin{frame}{Scalability}
  \centering
  \input{impact.tex}
\end{frame}

\begin{frame}{Properties of Programs vs. Inference Algorithms}
  \centering
  \input{line_plots.tex}
\end{frame}

\begin{frame}{Properties of Programs vs. Inference Algorithms}
  \centering
  \input{../paper/bars.tex}
\end{frame}

\section{Summary}

% * a full example for independence propagation (with an adjacency matrix)
% * specific constraints
% TODO: finish the slide
\begin{frame}{Summary}
  \begin{itemize}
  \item foo
  \item bar
  \item baz
  \end{itemize}
  \begin{block}{The implementation of the model is available at}
    \url{https://github.com/dilkas/random-logic-programs}
  \end{block}
\end{frame}

% ===============================================================

\begin{frame}
  \begin{block}{Adjacency matrix representation}
    $A[i][j] = 0 \iff \nexists k: \texttt{clauseAssignments}[k] = j$ and $i
    \in \texttt{clauses}[k].\texttt{treeValues}$
  \end{block}
  \begin{block}{New constraints}
    \begin{itemize}
    \item No (negative) cycles
      \begin{itemize}
      \item No clever propagation, just entailment checking.
      \end{itemize}
    \item Independence. Propagation:
      \begin{itemize}
      \item Two types of dependencies: determined and
        one-undetermined-edge-away-from-being-determined.
      \item Look up the dependencies of both predicates. For each pair of
        matching dependencies:
        \begin{itemize}
        \item If both are determined, fail.
        \item If one is determined, the selected edge of the other must not
          exist.
        \end{itemize}
      \end{itemize}
    \end{itemize}
  \end{block}
\end{frame}

\end{document}